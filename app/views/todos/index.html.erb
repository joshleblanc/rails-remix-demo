<h1 class="my-3 font-semibold">Todos</h1>

<ul class="w-1/2">
  <% @todos.each do |todo| %>
    <li data-controller="toggle" class="<%= item_classes('p-2') %>" id="<%= dom_id(todo, :item) %>">
      <div class="w-full">
        <%= form_for todo, data: { controller: 'fetcher submit-on-change' }, html: { class: 'w-full' } do |form| %>
          <label data-toggle-target="toggle">
            <%= form.check_box :completed, class: checkbox_classes("mr-2") %>
            <span><%= todo.title %></span>
          </label>
          <div class="hidden" data-toggle-target="toggle">
            <%= form.text_field :title, class: input_classes('w-full'), autofocus: true, data: { action: "blur->toggle#toggle keydown->toggle#close" } %>
          </div>
        <% end %>
      </div>
      <div class="flex items-center">
        <%= render partial: 'status', locals: { todo: todo } %>

        <%= button_tag "Edit", type: 'button', class: button_classes, data: { action: "toggle#toggle", toggle_target: "toggle" } %>
        <%= button_to "Delete", todo, method: :delete, form: { data: { controller: 'fetcher' }, id: dom_id(todo, :delete) }, class: button_classes('focus:ring-red-500 text-white bg-red-600 ml-2') %>
      </div>
    </li>
  <% end %>
</ul>

<%= form_for @todo, html: { class: 'mt-4 w-1/2 flex items-center' } do |form| %>
  <%= form.text_field :title, class: input_classes('flex-grow mr-2'), autofocus: true %>
  <%= form.button "Add", class: button_classes %>
<% end %>
